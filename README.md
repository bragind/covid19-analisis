#  Анализ метаданных рентгеновских снимков при COVID-19 и других пневмониях

Проект выполняет полный цикл анализа открытого набора данных [covid-chestxray-dataset](https://github.com/ieee8023/covid-chestxray-dataset) — от загрузки и очистки до SQL-аналитики и визуализации. .

##  Инструкция по запуску (Google Colab)

1. Откройте [Google Colab](https://colab.research.google.com/).
2. Откройте файл analisis.ipynb
3. Запустите последовательно каждую ячейку


## Что делает код?

### 1. **Очистка данных**
- Заполняет пропуски (`"unknown"` для категорий, медиана для числовых).
- Унифицирует диагнозы:
  - `COVID-19 pneumonia`,
  - `SARS pneumonia`,
  - `Other pneumonia`.
- Удаляет дубликаты по ключу: `patientid`, `offset`, `date`, `filename`.

### 2. **SQL-аналитика**
- Статистика по диагнозам и возрасту.
- Распределение по полу.
- Топ-3 самых пожилых пациентов в каждой группе.
- Временные тренды (2003–2020).
- Связь проекций снимков (`PA`, `AP Supine`) и диагнозов.

### 3. **Визуализация**
-  **Круговая диаграмма**: 61.5% — COVID-19.
-  **Столбчатая диаграмма**: 83% пациентов — старше 40 лет.
-  **Линейный график**: резкий рост в 2020 году.
-  **Heatmap**: PA — основная проекция для COVID-19.

### 4. **Сохранение**
- Результаты сохраняются в **Parquet** (оптимизированный формат) с партиционированием по `finding`.

---

##  Технические детали

- **Язык**: Python
- **Библиотеки**: PySpark, Pandas, Matplotlib, Seaborn
- **Среда**: Google Colab 
- **Исходные данные**: `metadata.csv` из GitHub-репозитория [ieee8023/covid-chestxray-dataset](https://github.com/ieee8023/covid-chestxray-dataset)

---


##  Автор

- **Имя**: Дмитрий Брагин  
- **GitHub**: [bragind](https://github.com/bragind)



